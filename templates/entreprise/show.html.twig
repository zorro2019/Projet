{% extends 'base.html.twig' %}

{% block title 'Entreprise' %}

{% block body %}
    <div id="all">
    <!-- Top bar-->
    <div class="top-bar">
        <div class="container">
            <div class="row d-flex align-items-center">
                <div class="col-md-6 d-md-block d-none">
                    <p>Contacts&nbsp;<a class="text-white" href="tel:#">+221778213119</a> ou <a class="text-white" href="mailto:#">contact.fret-Online@gmail.com</a>.</p>
                </div>
                <div class="col-md-6">
                    <div class="d-flex justify-content-md-end justify-content-between">
                        <ul class="list-inline contact-info d-block d-md-none">
                            <li class="list-inline-item"><a href="tel:#"><i class="fa fa-phone"></i></a></li>
                            <li class="list-inline-item"><a href="mailto:#"><i class="fa fa-envelope"></i></a></li>
                        </ul>
                        <div class="login">
                            {% if app.user == false %}
                                <a href="{{ path('login') }}" class="login-btn"><i class="fa fa-sign-in"></i><span class="d-none d-md-inline-block">Se connecter</span></a>
                            {% endif %}
                            {% if app.user == false %}
                                <a href="{{ path('create_compte') }}" class="signup-btn"><i class="fa fa-user"></i><span class="d-none d-md-inline-block">Créer un compte</span></a>
                            {% endif %}
                            {% if app.user  %}
                                <a href="{{ path('user_espace') }}" class="login-btn">Mon Espace &nbsp;<i class="fa fa-user-o"></i></a>
                            {% endif %}
                            {% if app.user  %}
                                <a href="{{ path('logout') }}" class="login-btn">Déconnection&nbsp;&nbsp;<i class="fa fa-sign-out"></i></a>
                            {% endif %}
                        </div>
                        <ul class="social-custom list-inline">
                            <li class="list-inline-item"><a href="#"><i class="fa fa-facebook"></i></a></li>
                            <li class="list-inline-item"><a href="#"><i class="fa fa-google-plus"></i></a></li>
                            <li class="list-inline-item"><a href="#"><i class="fa fa-twitter"></i></a></li>
                            <li class="list-inline-item"><a href="#"><i class="fa fa-envelope"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Top bar end-->
    <!-- Navbar Start-->
    <header class="nav-holder make-sticky">
        <div id="navbar" role="navigation" class="navbar navbar-expand-lg">
            <div class="container"><a href="{{ path('home') }}" class="navbar-brand home">
                    <h2 class="d-none d-md-inline-block"><br>Frêt Online</h2>
                </a>
                <button type="button" data-toggle="collapse" data-target="#navigation" class="navbar-toggler btn-template-outlined"><span class="sr-only">Toggle navigation</span><i class="fa fa-align-justify"></i></button>
                <div id="navigation" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item nav_link nav_link_active">
                            <a class="nav-link active lnk" href="{{ path('home') }}">Home<span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item nav_link">
                            <a class="nav-link lnk" href="{{ path('fret.direct') }}">Fret en direct</a>
                        </li>
                        <li class="nav-item nav_link">
                            <a class="nav-link lnk" href="{{ path('alert.fret') }}">Alert fret</a>
                        </li>
                        <li class="nav-item nav_link">
                            <a class="nav-link lnk" href="{{ path('faq') }}">Comment ça marche ?</a>
                        </li>
                        <li class="nav-item nav_link">
                            <a class="nav-link lnk" href="{{ path('contact') }}">Contact</a>
                        </li>
                    </ul>
                </div>
                <div id="search" class="collapse clearfix">
                    <form role="search" class="navbar-form">
                        <div class="input-group">
                            <input type="text" placeholder="Search" class="form-control"><span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button></span>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </header>
    <!-- Navbar End-->
    <div id="heading-breadcrumbs">
        <div class="container">
            <div class="row d-flex align-items-center flex-wrap">
                <div class="col-md-7">
                    <h1 class="font-weight-bold text-primary"><i class="fa fa-angle-right">&nbsp; Entreprise</i></h1>
                </div>
                <div class="col-md-5">
                    <ul class="breadcrumb d-flex justify-content-end">
                        <li class="breadcrumb-item"><a href="{{ path('home') }}">Home</a></li>
                        <li class="breadcrumb-item active">Entreprise</li>
                    </ul>
            </div>
        </div>
        </div>
    </div>
    <div class="container mt-5">
            <div class="heading">
                <h2>Espace Entreprise</h2>
            </div>
            <div class="card mt-3 border-primary">
            <div class="row col-md-12 mt-3">
                <div class="offset-md-1 col-md-7">
                    <h2>{{ entreprise.nom }}</h2>
                    <p><strong><i class="fa fa-address-book-o"></i>&nbsp;Adresse : </strong> {{ entreprise.adresse }} </p>
                    <p><strong><i class="fa fa-toolbox"></i>&nbsp;Ville : </strong>{{ entreprise.ville }}</p>
                    <p><strong><i class="fa fa-phone"></i>&nbsp;Tél : </strong> 00221 {{ entreprise.tel }}</p>
                    <p><strong><i class="fa fa-vcard"></i>&nbsp;Assurance : </strong>{{ entreprise.compagnieAssurance }}</p>
                    <p><strong><i class="fa fa-clock-o"></i>&nbsp;Date inscription : </strong>{{ entreprise.createAt.format('d/m/y') }}</p>
                    <p><strong>Zones Intervations : </strong>
                        {% for zone in entreprise.listeZone %}
                            <span class="tags">{{ zone.nomZone }}</span>
                        {% endfor %}
                    </p>
                </div>
                <div class="col-md-4 text-center">
                    <figure>
                        <img src="{{ vich_uploader_asset(entreprise,'imageLogo') }}" width="200px" height="200px;" alt="" class="rounded-circle img-circle img-responsive">
                        <figcaption class="ratings">
                            <p>Notes
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star-o"></span>
                                </a>
                            </p>
                        </figcaption>
                    </figure>
                </div>
            </div>
            <hr>
            <div class="row col-md-12 mb-3">
                <div class="col-xs-12 col-md-4 emphasis text-center">
                    <h2><strong> {{ entreprise.nbreAbonne }} </strong></h2>
                    <p><small>Abonnés</small></p>
                    <button class="btn btn-success btn-block"><span class="fa fa-users"></span> Utilisateurs </button>
                </div>
                <div class="col-xs-12 col-md-4 emphasis text-center">
                    <h2><strong>{{ total }}</strong></h2>
                    <p><small>véhicules</small></p>
                    <button class="btn btn-info btn-block"><span class="fa fa-truck"></span> Nombre de camion </button>
                </div>
                <div class="col-xs-12 col-md-4 emphasis text-center">
                    <h2><strong>5</strong></h2>
                    <p><small>options</small></p>
                    <div class="btn-group dropup btn-block">
                        <button type="button" class="btn btn-primary"><span class="fa fa-gear"></span> Options </button>
                        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <ul class="dropdown-menu text-left" role="menu">
                            <li><a href="#"><span class="fa fa-envelope pull-right"></span>  Contacter par email </a></li>
                            <li><a href="#"><span class="fa fa-list pull-right"></span> Add or remove from a list  </a></li>
                            <li class="divider"></li>
                            <li><a href="#"><span class="fa fa-warning pull-right"></span>Report this user for spam</a></li>
                            <li class="divider"></li>
                            <li><a href="#" class="btn disabled" role="button"> Unfollow </a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% for u in entreprise.abonnes %}
        {% if u.id == user.id %}
            <div class="container mt-5">
                <section class="bar">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-3">
                                <div class="panel panel-default sidebar-menu with-icons">
                                    <div class="panel-heading">
                                        <h3 class="h4 panel-title">Gestion Entreprise</h3>
                                    </div>
                                    <div class="card-body">
                                        <ul class="nav nav-pills flex-column text-sm nav nav-tabs" id="myTab" role="tablist">
                                            <li class="nav-item">
                                                <a class="nav-link active" id="info-tab" data-toggle="tab" href="#info" role="tab"
                                                   aria-controls="info" aria-selected="true"><i
                                                            class="fa fa-briefcase"></i> Editer entreprise</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="user-tab" data-toggle="tab" href="#user" role="tab"
                                                   aria-controls="user" aria-selected="false"><i
                                                            class="fa fa-users"></i> Utilisateur</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-9 tab-content profile-tab mt-5" id="myTabContent">
                                <div class="tab-pane fade show active mt-2 mb-2 ml-2 mr-2" id="info" role="tabpanel"
                                     aria-labelledby="info-tab">
                                    <div class="heading">
                                        <h5>Editer l'entreprise</h5>
                                    </div>
                                    <div class="mt-3">
                                        {{ form_start(form) }}
                                        <div class="row">
                                            <div class="form-group col-md-6">
                                                <label for="">Nom</label>
                                                <div>{{ form_errors(form.nom) }}</div>
                                                <div>{{ form_widget(form.nom) }}</div>
                                            </div>
                                            <div class="form-group col-md-6">
                                                <label for="">Ninea</label>
                                                <div>{{ form_errors(form.ninea) }}</div>
                                                <div>{{ form_widget(form.ninea) }}</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group col-md-6">
                                                <label for="">Ville</label>
                                                <div>{{ form_errors(form.ville) }}</div>
                                                <div>{{ form_widget(form.ville) }}</div>
                                            </div>
                                            <div class="form-group col-md-6">
                                                <label for="">Adresse</label>
                                                <div>{{ form_errors(form.adresse) }}</div>
                                                <div>{{ form_widget(form.adresse) }}</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group col-md-6">
                                                <label for="">Telephone</label>
                                                <div>{{ form_errors(form.tel) }}</div>
                                                <div>{{ form_widget(form.tel) }}</div>
                                            </div>
                                            <div class="form-group col-md-6">
                                                <label for="">Logo</label>
                                                <div>{{ form_errors(form.imageLogo) }}</div>
                                                <div>{{ form_widget(form.imageLogo) }}</div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group col-md-6">
                                                <label for="">Compagnie Assurance</label>
                                                <div>{{ form_errors(form.compagnieAssurance) }}</div>
                                                <div>{{ form_widget(form.compagnieAssurance) }}</div>
                                            </div>
                                            <div class="form-group col-md-6">
                                                    <label for="">Zones Interventions</label>
                                                    <select name="zone[]" id="" aria-multiselectable="true" class="form-control select2" multiple="multiple">
                                                        {% for zone in zones %}
                                                            <option value="{{ zone.id}}">{{ zone.nomZone }}</option>
                                                        {% endfor %}
                                                    </select>
                                            </div>
                                        </div>
                                        <div class="row">
                                            {{ form_rest(form) }}
                                            <div class="offset-md-4 col-md-4">
                                                <button type="submit" class="btn btn-primary btn-labeled pull-right">Valider&nbsp;<span
                                                            class="btn-label btn-label-right"><i class="fa fa-check"></i></span></button>
                                            </div>
                                        </div>
                                        {{ form_end(form) }}
                                    </div>
                                </div>
                                <div class="tab-pane fade mt-2 mb-2 ml-2 mr-2 border-primary" id="user" role="tabpanel"
                                     aria-labelledby="user-tab">
                                    <div class="card border-0">
                                        <div class="heading mt-3">
                                            <h3>Les Utilisateurs</h3>
                                        </div>
                                        <table class="table-striped text-center ml-1 mb-3 mr-1">
                                            <thead>
                                            <tr>
                                                <th>Nom</th>
                                                <th>Prenom</th>
                                                <th>Email</th>
                                                <th>Inscription</th>
                                                <th>Action</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for ab in entreprise.abonnes %}
                                                <tr>
                                                    <td>{{ ab.nom }}</td>
                                                    <td>{{ ab.prenom }}</td>
                                                    <td>{{ ab.email }}</td>
                                                    <td>{{ ab.createdAt.format('d/m/y') }}</td>
                                                    <td><a href="{{ path('abonne.show',{id:ab.id}) }}" class="btn btn-secondary">Voir</a></td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </section>
            </div>
        {% endif %}
    {% endfor %}
{% endblock %}